# -*- coding: utf-8 -*-
"""
场景识别增强版配置（支持 intent + top1 + top3 + top7）
"""

# ==================================================
# 44 个预定义场景（含个人信息）
# ==================================================
SCENE_LIST = [
    "地图导航",
    "打车服务",
    "即时通信聊天服务",
    "电话通话",
    "网络社区",
    "网络支付",
    "网上购物",
    "餐饮外卖",
    "邮寄服务",
    "交通票务",
    "婚恋相亲",
    "求职招聘",
    "网络借贷",
    "房屋租售",
    "汽车交易",
    "医疗健康",
    "旅游服务",
    "酒店预定",
    "网络游戏",
    "学习教育",
    "维修装修",
    "女性健康",
    "汽车单车租赁",
    "投资理财",
    "手机银行",
    "网络邮箱",
    "远程会议",
    "网络直播",
    "在线影音",
    "新闻资讯",
    "运动健身",
    "浏览器",
    "杀毒软件",
    "电子图书",
    "拍摄美化",
    "应用商店",
    "天气",
    "日历",
    "实用工具",
    "文件管理",
    "娱乐票务",
    "用户登录",
    "其他",
    "广告",
    "个人信息"
]

# ==================================================
# 新版 Prompt（两阶段推理 + intent + top7）
# ==================================================

SCENE_PROMPT = """
你是一名专业的 Android UI 功能理解专家，你需要从一段 UI 交互链中推断应用正在执行什么功能，并将它归类为 44 个预定义场景之一。

请严格按照以下两步推理：

============================================================
【步骤 1：推断 UI 的功能意图（intent）】
请根据以下信息总结页面的功能目标：
- APP 的类型（如果提供）
- 权限请求类型，以及为何需要权限
- before → granting → after 的内容变化
- 控件结构（按钮、输入框、列表、视频等）
- 页面中的关键词、文本布局、典型交互模式

请用 1–2 句总结，例如：
- “这是一个拍照上传页面，需要存储/相机权限”
- “这是一个语音聊天页面，需要麦克风权限”
- “这是一个直播观看页面”
- “这是一个工具类应用的功能页”

============================================================
【步骤 2：从 44 类场景中选择最合理的分类】
请从以下场景列表中选择：
{SCENE_LIST}

要求：
- top1 必须是你最确信的分类
- top3 必须包含 3 个互不相同且来自列表的场景，top1 作为第一个元素
- top7 必须包含 7 个互不相同且来自列表的场景，top1 作为第一个元素
- 即使不确定，也必须补满 3 和 7 项，用“次优但相关”的场景填充
- 不得输出列表外的类别名

============================================================
【输出 JSON（必须严格遵守）】
你必须只输出 JSON，不得包含额外解释文字：

{
  "intent": "功能意图",
  "top1": "场景名称",
  "top3": ["场景1", "场景2", "场景3"],
  "top7": ["场景1", "场景2", "场景3", "场景4", "场景5", "场景6", "场景7"]
}

============================================================
下面是待分析的 UI 特征（文本、控件结构、权限、页面序列）：
{FEATURE}
"""


# ==================================================
# vLLM 配置
# ==================================================
VLLM_URL = "http://localhost:8001/v1/chat/completions"
MODEL_NAME = "Qwen2.5-7B"


# ==================================================
# 超参（可调整）
# ==================================================
MAX_STEPS = 6       # before + granting + after 保留的最大步骤
MAX_WIDGETS = 10     # 每个界面最多取多少 widgets
MAX_TEXT_LEN = 400   # 每段 text 最大长度
MAX_TOTAL_LEN = 3000 # 最终输入给模型的字符上限（避免溢出）